name: üöÄ Deploy Opoquiz via SFTP

# Se ejecuta cada vez que haces push a la rama main
on:
  push:
    branches:
      - main  # Cambia si usas otra rama principal

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      # 1Ô∏è‚É£ Descargar el c√≥digo de GitHub
      - name: Checkout code
        uses: actions/checkout@v3

      # 2Ô∏è‚É£ Subir archivos v√≠a SFTP a Alwaysdata
      - name: Deploy to Alwaysdata via SFTP
        uses: appleboy/scp-action@master
        with:
          host: ftp-mascu.alwaysdata.net       # Host SFTP de Alwaysdata (verifica en tu panel)
          username: ${{ secrets.ALWAYSDATA_FTP_USER }}  # Tu usuario FTP
          password: ${{ secrets.ALWAYSDATA_FTP_PASS }}  # Tu contrase√±a FTP
          port: 22                             # Puerto SFTP est√°ndar
          source: "backend/*"                  # Carpeta local que quieres subir
          target: "/www/quiz/backend/"         # Carpeta destino en Alwaysdata
          strip_components: 1                  # Quita la carpeta ra√≠z 'backend' si quieres subir solo su contenido
          recursive: true                      # Subir carpetas y subcarpetas